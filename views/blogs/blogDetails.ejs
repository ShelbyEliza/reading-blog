<!DOCTYPE html>
<html lang="en">
  <%- include('../partials/head.ejs') %>
  <body>
    <%- include('../partials/header.ejs') %> <%- include('../partials/nav.ejs')
    %>

    <div class="content">
      <div class="content-box">
        <div class="content-box-top">
          <div class="content-box-heading">
            <h1 class="title"><%= blog.bookTitle %></h1>
            <a class="authorLink" href="/categories/author/<%= blog.authorID %>">
              <h2 class="author"><%= blog.author %></h2>
            </a>  
          </div>
          <div class="edit-button-container">
            <a class="edit" href="/blogs/editBlog/<%= blog.id %>">
              <img 
                class="edit-button-image"
                src="../../images/edit-opt.svg"
                alt="An icon depicting a pencil, with directs to the edit blog page."
              />
            </a>
          </div>
          <div class="thumbnail">
            <img
              class="title-banner-image"
              src="../../images/test-image-opt.svg"
              alt="An image of some stylized purple outlined trees on a dark landscape."
            />
          </div>
        </div>
        <div class="blog-snippet"><%= blog.blogContent %></div>
        <div class="delete-button">
          <a class="delete" data-doc="<%= blog.id %>"> 
            <img
            class="delete-button-image"
            src="../../images/garbage-final.svg"
            alt="An image of a green trashcan with yellow crumbled up garbage in it."
          />
          </a>
        </div>
      </div>
    </div>  
    <script>
      const trashcan = document.querySelector("a.delete");

      trashcan.addEventListener("click", (e) => {
        const endpoint = `/blogs/${trashcan.dataset.doc}`;

        fetch(endpoint, {
          method: "DELETE",
        })
        .then((response) => response.json())
        .then((data) => (window.location.href = data.redirect)) 
        .catch((err) => {
          console.log(err);
        });  
      });
    </script>
  </body>
</html> 
